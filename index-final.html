<DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://dimplejs.org/dist/dimple.v2.0.0.min.js"></script>
    <link href="css/style.css" rel="stylesheet" />


    <script type="text/javascript">
    
    /*Set global variables*/
    "use strict";
    var margin = 75;
    var width = 1400 - margin; 
    var height =700 - margin; 
    var fontsize = "14px";
    var titlefont = "25px";
    /*set up draw function for the top_five_delay list*/
    function draw1(data){
        
        /*D3.js setup code */

        var svg = d3.select("body")
        .append("svg").attr("width", width).attr("height", height)
        .append('g').attr('class','chart1')
        

        /*Dimple.js setup code*/

        var myChart = new dimple.chart(svg, data);
        var x = myChart.addCategoryAxis("x", "carrier_name");
        x.title = 'Carrier Name';
        x.fontSize = fontsize;

        var y = myChart.addMeasureAxis("y", "ave_delayed");
        y.title = 'Average Number of Delayed Flights'
        y.fontSize = fontsize;
        var series = myChart.addSeries(null, dimple.plot.bar);
        series.barGap = 0.5;
        myChart.draw();    

        svg.append("text")
        .attr("x", (width / 2))             
        .attr("y", margin/2)
        .attr("text-anchor", "middle")  
        .style("font-size", titlefont) 
        .style("text-decoration", "bold")  
        .text("Top Five Airlines with the Highest Average Number of Delayed Flight, 2005-2015");

        
        /*Add mouseover effect for bar chart */    
        
        svg.selectAll("rect")
        .on('mouseover', function(e){
            d3.select(this)
            .style("stroke-width", "5px")
            .style("opacity", 2)
            .style("fill", "green")
        })
        .on('mouseleave', function(e){
            d3.select(this)
            .style("stroke-width", "0px")  
            .style("fill", "lightblue")  
        })

    }

    /*set up draw function for the top_five_onetime list*/
    function draw2(data){
        
        /*D3.js setup code */

        var svg = d3.select("body")
        .append("svg").attr("width", width).attr("height", height)
        .append('g').attr('class','chart2')

        /*Dimple.js setup code*/

        var myChart = new dimple.chart(svg, data);
        var x = myChart.addCategoryAxis("x", "carrier_name");
        x.fontSize = fontsize;
        x.title = 'Carrier Name';

        var y = myChart.addMeasureAxis("y", "ave_ontime");
        y.title = 'Average percentage of on-time flights';
        y.tickFormat = '%';
        y.fontSize = fontsize;
        var series = myChart.addSeries(null, dimple.plot.bar);
        series.barGap = 0.5
        myChart.draw();   

        svg.append("text")
        .attr("x", (width / 2))             
        .attr("y", margin/2)
        .attr("text-anchor", "middle")  
        .style("font-size", titlefont) 
        .style("text-decoration", "bold")  
        .text("Top Five Airlines with the Highest Average Percentage of On-Time Flight, 2005-2015");   

        /*Add mouseover effect for bar chart */    
        svg.selectAll("rect")
        .on('mouseover', function(e){
            d3.select(this)
            .style("stroke-width", "5px")
            .style("opacity", 2)
            .style("fill", "green")
   
        })
        .on('mouseleave', function(e){
            d3.select(this)
            .style("stroke-width", "0px")  
            .style("fill", "lightblue")  
        })

    }

    /*set up draw function for the most_common_delay_cause list*/
    function draw3(data){
        
        /*D3.js setup code */ 

        var svg = d3.select("body")
        .append("svg").attr("width", width).attr("height", height)
        .append('g').attr('class','chart3')

        /*Dimple.js setup code*/

        var myChart = new dimple.chart(svg, data);
        var x = myChart.addCategoryAxis("x", ["carrier_name", 'variable']);
        x.title = 'Carrier Name';
        x.fontSize = fontsize;

        var y = myChart.addMeasureAxis("y", "value");
        y.title = 'The averaged number of flights';
        y.fontSize = fontsize;
        var series = myChart.addSeries("variable", dimple.plot.bar);
        var story = myChart.setStoryboard("carrier_name");
        story.frameDuration = 60;
        var legend = myChart.addLegend(width*0.65, 60, width*0.25, 60, 'right');
        legend.fontSize = fontsize;
        myChart.draw();

        svg.append("text")
        .attr("x", (width / 2))             
        .attr("y", margin/2)
        .attr("text-anchor", "middle")  
        .style("font-size", titlefont) 
        .style("text-decoration", "bold")  
        .text("Average Number of Delayed Flight by Different Cause, 2005-2015"); 

    }
    
    </script>
</head>
<body>
    <script type=text/Javascript>
    /* Use D3 to load "most_common_delay_cause.csv" */
    d3.csv("data/top_five_delay.csv", draw1)
    d3.csv("data/top_five_on_time.csv", draw2)
    d3.csv("data/most_common_delay_cause.csv", draw3)
    
    </script>
</body>
</html>

